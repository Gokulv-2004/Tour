<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pack Your Bag - Booking</title>
  <link rel="stylesheet" href="booking.css"> 
  <link rel="icon" type="image/webp" href="/image/icon.webp" />
</head>
<body>
  <h1>Pack Your Bag - Booking Page</h1>
  <form id="bookingForm">
    <label>Full Name: <input type="text" id="name" required></label><br><br>
    <label>Phone Number: <input type="tel" id="phone" required maxlength="10"></label><br><br>
    <label>Email: <input type="email" id="email" required></label><br><br>
    <label>Total Members: <input type="number" id="members" min="1" max="40" value="1" required></label><br><br>
    <label>Gender:
      <input type="radio" name="gender" value="Male" required> Male
      <input type="radio" name="gender" value="Female"> Female
    </label><br><br>
    <label>Tour Date: <input type="date" id="date" required></label><br><br>
    <label>From: <input type="text" id="from" required></label><br><br>
    
    <label>INNER KARNATAKA'S Package:
      <select id="package" required>
        <option value="">-- Select a Package --</option>
      </select>
    </label><br><br>

    <label>Payment Method:
      <select id="payment" required>
        <option value="UPI">UPI</option>
        <option value="Credit Card">Credit Card</option>
        <option value="Debit Card">Debit Card</option>
      </select>
    </label><br><br>

    <button type="submit">Book Now</button>
  </form>

<script>
  let prices = {
    packages: {},
    seasons: {
      "SPRING": 1000,
      "SUMMER": 1500,
      "MONSOON": 1300,
      "WINTER": 1700,
      "NULL": ""
    }
  };

  // Load places from places.json
  async function loadPlaces() {
    try {
      const response = await fetch('places.json');
      if (!response.ok) throw new Error("Failed to load places.json");

      const places = await response.json();
      const packageSelect = document.getElementById('package');

      places.forEach(place => {
        const option = document.createElement('option');
        option.value = place.name;
        option.textContent = `${place.name} - ₹${place.price}`;
        packageSelect.appendChild(option);

        prices.packages[place.name] = place.price;
      });
    } catch (err) {
      console.error("Error loading places.json:", err);
      alert("Could not load packages. Please try again later.");
    }
  }

  document.getElementById('bookingForm').addEventListener('submit', function (e) {
    e.preventDefault();

    const package = document.getElementById('package').value;
    const members = parseInt(document.getElementById('members').value);

    const total = prices.packages[package] || 0;
    const totalCost = total * members;

    const booking = {
      name: document.getElementById('name').value,
      phone: document.getElementById('phone').value,
      email: document.getElementById('email').value,
      members: members,
      gender: document.querySelector('input[name="gender"]:checked').value,
      date: document.getElementById('date').value,
      from: document.getElementById('from').value,
      package: package,
      payment: document.getElementById('payment').value,
      totalCost: totalCost
    };

    let allBookings = JSON.parse(localStorage.getItem('bookings')) || [];
    allBookings.push(booking);
    localStorage.setItem('bookings', JSON.stringify(allBookings));

    alert(`Booking Confirmed! Total Price: ₹${totalCost}`);
    document.getElementById('bookingForm').reset();
    window.location.href = '/'
  });

  loadPlaces(); 
</script>
</body>
</html>
